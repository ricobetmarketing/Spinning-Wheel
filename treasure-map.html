<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>VIP Day ‚Äì Treasure Map</title>
<style>
:root{--bg:#0e0f23;--card:#111228;--ring:rgba(255,255,255,.12);--text:#f2f3ff;--dim:#b9baf5;--warn:#ffe600;--a1:#ff6ec4;--a2:#7873f5}
*{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
.wrap{max-width:560px;margin:0 auto;padding:20px 14px}
.card{background:var(--card);border:1px solid var(--ring);border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,.45);padding:16px;text-align:center;position:relative;overflow:hidden}
h1{margin:6px 0 4px;font-size:1.2rem}.grad{background:linear-gradient(90deg,var(--a1),var(--a2));-webkit-background-clip:text;background-clip:text;color:transparent}
.sub{margin:0 10px 14px;color:var(--dim)}

.map{position:relative;overflow:hidden;border-radius:14px;background:#0f1128;border:1px solid var(--ring);height:200px}
.grid{position:absolute;inset:10px;border:1px dashed #2a2d63;background:
  repeating-linear-gradient(0deg,transparent 0 28px,rgba(255,255,255,.03) 28px 29px),
  repeating-linear-gradient(90deg,transparent 0 28px,rgba(255,255,255,.03) 28px 29px);border-radius:10px}
.x{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:34px;color:var(--warn);cursor:pointer}
.chest{position:absolute;bottom:14px;left:50%;transform:translateX(-50%);width:92px;height:60px;border-radius:8px 8px 4px 4px;background:linear-gradient(180deg,#9c5a24,#5a2f0f);border:2px solid #2f1404;box-shadow:inset 0 8px rgba(255,255,255,.08),0 8px 16px rgba(0,0,0,.35)}
.chest:before{content:"";position:absolute;top:-10px;left:0;right:0;height:16px;border-radius:8px 8px 0 0;background:linear-gradient(180deg,#b06a2e,#6a3814);border-bottom:2px solid #2f1404}
.card.open .chest{animation:lift 600ms ease forwards}
@keyframes lift{50%{transform:translateX(-50%) translateY(-6px)}100%{transform:translateX(-50%) translateY(-4px);box-shadow:0 12px 20px rgba(255,230,0,.3),0 0 40px rgba(255,230,0,.3)}}

.reveal{opacity:0;visibility:hidden;margin-top:12px;border:1px dashed var(--ring);border-radius:12px;background:#10122b;padding:14px;transition:opacity .22s ease}
.reveal.show{opacity:1;visibility:visible;animation:bounceIn .6s ease, glow 1.5s ease-out 2}
@keyframes bounceIn{0%{opacity:0;transform:scale(.86) translateY(22px)}60%{opacity:1;transform:scale(1.05) translateY(-4px)}100%{transform:scale(1) translateY(0)}}
@keyframes glow{0%{box-shadow:0 0 0 rgba(255,230,0,.0)}50%{box-shadow:0 0 16px rgba(255,230,0,.9)}100%{box-shadow:0 0 0 rgba(255,230,0,.0)}}

.shake{animation:shake .4s ease}
@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-6px)}40%{transform:translateX(6px)}60%{transform:translateX(-3px)}80%{transform:translateX(3px)}}

.codebox{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.code{flex:1 1 220px;min-width:180px;padding:10px;border-radius:10px;border:1px solid var(--ring);background:#0f1128;color:#f2f3ff;font-family:ui-monospace,Menlo,Consolas,monospace}
.copy{flex:0 0 auto;border:0;border-radius:999px;padding:10px 14px;font-weight:800;background:linear-gradient(90deg,#ff6ec4,#7873f5);color:#0e0f23;cursor:pointer}
.note{margin-top:6px;color:var(--dim);font-size:.85rem}.ok{display:none;color:#1dd1a1}

/* Confetti layer */
.cfx{pointer-events:none;position:absolute;inset:0;overflow:hidden;z-index:5;display:none}
.cfx.show{display:block}
.cfx i{position:absolute;top:-10px;width:8px;height:12px;border-radius:2px;opacity:.95;background:var(--conf,#fff);
       transform:translateY(-20px) rotate(0deg);animation:fall 1.1s ease forwards;box-shadow:0 0 8px rgba(0,0,0,.25)}
@keyframes fall{to{transform:translateY(220px) rotate(360deg);opacity:.98}}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="card" data-done="0" data-codes='["SAYANG","LUCKY"]'>
    <h1><span class="grad">VIP Day</span> ‚Äì Treasure Map üó∫Ô∏è</h1>
    <p class="sub">Tap the X to dig up your reward.</p>

    <div class="map" aria-hidden="true">
      <div class="grid"></div>
      <div class="x" id="dig" role="button" tabindex="0" aria-label="Dig here">‚úñ</div>
      <div class="chest" id="chest"></div>
    </div>

    <div class="reveal" id="reveal">
      <div class="codebox">
        <span>üè¥‚Äç‚ò†Ô∏è Your VIP code:</span>
        <input id="code" class="code" type="text" value="" readonly onclick="this.select();try{document.execCommand('copy');}catch(e){}">
        <button id="copyBtn" class="copy">Copy</button>
      </div>
      <div class="note"><span class="tip">Tap Copy or long-press to copy.</span> <span id="copied" class="ok">Copied ‚úî</span></div>
    </div>

    <div class="cfx" id="cfx"></div>
  </div>
</div>
<script>
(function(){
  var KEY_DONE='rb_vip_map_done_202509';
  var KEY_CODE='rb_vip_map_code_202509';

  var card=document.getElementById('card');
  var rev=document.getElementById('reveal');
  var dig=document.getElementById('dig');
  var codeInput=document.getElementById('code');
  var copyBtn=document.getElementById('copyBtn');
  var copied=document.getElementById('copied');
  var cfx=document.getElementById('cfx');

  // Restore if already played
  try{
    if(localStorage.getItem(KEY_DONE)==='1'){
      var saved=localStorage.getItem(KEY_CODE)||'';
      codeInput.value=saved;
      revealWithEffects();
      card.setAttribute('data-done','1');
      card.classList.add('open');
    }
  }catch(e){}

  function confetti(){
    if(!cfx) return;
    cfx.classList.add('show'); cfx.innerHTML='';
    var colors=['#ff6ec4','#7873f5','#ffe600','#1dd1a1','#ffffff'];
    for(var i=0;i<32;i++){
      var s=document.createElement('i');
      s.style.left=(5+Math.random()*90)+'%';
      s.style.setProperty('--conf', colors[(Math.random()*colors.length)|0]);
      s.style.animationDelay=(Math.random()*0.25)+'s';
      cfx.appendChild(s);
    }
    setTimeout(function(){ cfx.classList.remove('show'); }, 1200);
  }

  function revealWithEffects(){
    card.classList.add('open');          // chest lift
    card.classList.add('shake');         // quick shake
    setTimeout(function(){ card.classList.remove('shake'); }, 420);
    rev.classList.add('show');           // bounce + glow
    confetti();
  }

  function pickRandomCode(){
    try{
      var arr = JSON.parse(card.getAttribute('data-codes')||'[]');
      if(!arr.length) return '';
      return arr[Math.floor(Math.random()*arr.length)]; // 50/50
    }catch(e){ return ''; }
  }

  function act(){
    if(card.getAttribute('data-done')==='1') return;
    dig.textContent='‚õèÔ∏è';
    setTimeout(function(){
      var chosen = pickRandomCode();
      codeInput.value = chosen;
      revealWithEffects();
      card.setAttribute('data-done','1');
      try{
        localStorage.setItem(KEY_DONE,'1');
        localStorage.setItem(KEY_CODE, chosen);
      }catch(e){}
    }, 500);
  }

  dig.addEventListener('click', act);
  dig.addEventListener('keydown', function(e){ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); act(); } });

  if(copyBtn){
    copyBtn.addEventListener('click', function(){
      codeInput.select();
      try{
        document.execCommand('copy');
        copied.style.display='inline';
        setTimeout(function(){ copied.style.display='none'; }, 1200);
      }catch(e){}
    });
  }
})();
</script>
</body>
</html>
